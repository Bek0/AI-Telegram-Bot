<!-- /dashboard/templates/dashboard.html -->
<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฏุงุด ุจูุฑุฏ</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="navbar">
        <div class="navbar-left">
            <h1>๐ข <span id="orgName">ุงููุคุณุณุฉ</span></h1>
        </div>
        <div class="navbar-right">
            <span id="userRole" class="role-badge"></span>
            <button class="btn btn-danger btn-sm" id="logoutBtn">ุฎุฑูุฌ</button>
        </div>
    </div>

    <div class="container">
        <!-- Stats Cards -->
        <div class="stats-grid" id="statsContainer">
            <div class="stat-card">
                <h3>๐ฅ ุงูุฃุนุถุงุก</h3>
                <div class="stat-number" id="membersCount">0</div>
            </div>
            <div class="stat-card">
                <h3>๐๏ธ ููุงุนุฏ ุงูุจูุงูุงุช</h3>
                <div class="stat-number" id="databasesCount">0</div>
            </div>
            <div class="stat-card">
                <h3>๐ง ุฏุนูุงุช ูุดุทุฉ</h3>
                <div class="stat-number" id="invitationsCount">0</div>
            </div>
            <div class="stat-card">
                <h3>๐ ุชุงุฑูุฎ ุงูุฅูุดุงุก</h3>
                <div class="stat-date" id="createdDate">-</div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="members">๐ฅ ุงูุฃุนุถุงุก</button>
            <button class="tab-btn" data-tab="databases">๐๏ธ ููุงุนุฏ ุงูุจูุงูุงุช</button>
            <button class="tab-btn" data-tab="invitations">๐ง ุงูุฏุนูุงุช</button>
            <button class="tab-btn" data-tab="costs" style="display: block;">๐ฐ ุงูุชูุงููู</button>
        </div>

        <!-- Members Tab -->
        <div class="tab-content active" id="members-tab">
            <div class="section">
                <h2>ุงูุฃุนุถุงุก</h2>
                
                <div id="addMemberForm" style="display: none;">
                    <div class="form-inline">
                        <input type="number" id="memberUserId" placeholder="ูุนุฑู ุงููุณุชุฎุฏู" min="1">
                        <button class="btn btn-success" onclick="addMember()">ุฅุถุงูุฉ ุนุถู</button>
                    </div>
                </div>

                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ูุนุฑู ุงููุณุชุฎุฏู</th>
                                <th>ุงูุฏูุฑ</th>
                                <th>ุชุงุฑูุฎ ุงูุงูุถูุงู</th>
                                <th id="actionsHeader" style="display: none;">ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="membersTable">
                            <tr><td colspan="4" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Databases Tab -->
        <div class="tab-content" id="databases-tab">
            <div class="section">
                <h2>ููุงุนุฏ ุงูุจูุงูุงุช</h2>
                
                <div id="createDatabaseForm" style="display: none;">
                    <div class="form-group">
                        <label for="databaseName">ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช:</label>
                        <input type="text" id="databaseName" placeholder="ุฃุฏุฎู ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช">
                    </div>
                    <div class="form-group">
                        <label for="connectionString">ุณูุณูุฉ ุงูุงุชุตุงู:</label>
                        <textarea id="connectionString" placeholder="ุฃุฏุฎู ุณูุณูุฉ ุงูุงุชุตุงู" rows="4"></textarea>
                    </div>
                    <button class="btn btn-success" onclick="createDatabase()">ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช</button>
                </div>

                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ุงูุงุณู</th>
                                <th>ูุนุฑู ุงูุงุชุตุงู</th>
                                <th>ุชุงุฑูุฎ ุงูุฅูุดุงุก</th>
                                <th id="dbActionsHeader" style="display: none;">ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="databasesTable">
                            <tr><td colspan="4" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Invitations Tab -->
        <div class="tab-content" id="invitations-tab">
            <div class="section">
                <h2>ุงูุฏุนูุงุช</h2>
                
                <div id="createInvitationForm" style="display: none;">
                    <div class="form-inline">
                        <input type="number" id="maxUses" placeholder="ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช" min="1" value="1">
                        <button class="btn btn-success" onclick="createInvitation()">ุฅูุดุงุก ุฏุนูุฉ</button>
                    </div>
                </div>

                <div id="invitationResult"></div>

                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ุงูุฑูุฒ</th>
                                <th>ุงูุงุณุชุฎุฏุงูุงุช</th>
                                <th>ุชุงุฑูุฎ ุงูุงูุชูุงุก</th>
                                <th>ุงูุญุงูุฉ</th>
                            </tr>
                        </thead>
                        <tbody id="invitationsTable">
                            <tr><td colspan="4" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
<!-- Costs Tab Content -->
<div id="costs-tab" class="tab-content">
    
    <!-- COSTS OVERVIEW CARDS -->
    <div class="stats-grid">
        <div class="stat-card">
            <h3>ุฅุฌูุงูู ุงูุชูุงููู</h3>
            <div class="stat-number" id="totalCost">$0.00</div>
        </div>
        <div class="stat-card">
            <h3>ุฅุฌูุงูู ุงููุฏุฎูุงุช</h3>
            <div class="stat-number" id="totalInputTokens">0</div>
            <div class="stat-date">ุฑูุฒ</div>
        </div>
        <div class="stat-card">
            <h3>ุฅุฌูุงูู ุงููุฎุฑุฌุงุช</h3>
            <div class="stat-number" id="totalOutputTokens">0</div>
            <div class="stat-date">ุฑูุฒ</div>
        </div>
        <div class="stat-card">
            <h3>ุนุฏุฏ ุงููุญุงุฏุซุงุช</h3>
            <div class="stat-number" id="totalConversations">0</div>
        </div>
    </div>

    <!-- INPUT/OUTPUT COSTS -->
    <div class="section">
        <h2>๐ ุชูุฒูุน ุงูุชูุงููู (ูุฏุฎูุงุช/ูุฎุฑุฌุงุช)</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">
            <div>
                <canvas id="costsPieChart" style="max-height: 300px;"></canvas>
            </div>
            <div style="padding: 20px;">
                <h3>ููุฎุต ุงูุชูุงููู</h3>
                <table style="width: 100%; margin-top: 15px;">
                    <tr>
                        <td style="padding: 10px; border-bottom: 1px solid #eee;">
                            <strong>ุชูุงููู ุงููุฏุฎูุงุช:</strong>
                        </td>
                        <td style="padding: 10px; border-bottom: 1px solid #eee; text-align: left;">
                            <span id="inputCost">$0.00</span>
                            <span style="color: #7f8c8d;">(<span id="inputPercentage">0%</span>)</span>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border-bottom: 1px solid #eee;">
                            <strong>ุชูุงููู ุงููุฎุฑุฌุงุช:</strong>
                        </td>
                        <td style="padding: 10px; border-bottom: 1px solid #eee; text-align: left;">
                            <span id="outputCost">$0.00</span>
                            <span style="color: #7f8c8d;">(<span id="outputPercentage">0%</span>)</span>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <!-- COSTS BY MODEL -->
    <div class="section">
        <h2>๐ค ุงูุชูุงููู ุญุณุจ ุงููููุฐุฌ</h2>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>ุงุณู ุงููููุฐุฌ</th>
                        <th>ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช</th>
                        <th>ุฑููุฒ ุงููุฏุฎูุงุช</th>
                        <th>ุฑููุฒ ุงููุฎุฑุฌุงุช</th>
                        <th>ุชูุงููู ุงููุฏุฎูุงุช</th>
                        <th>ุชูุงููู ุงููุฎุฑุฌุงุช</th>
                        <th>ุงูุฅุฌูุงูู</th>
                    </tr>
                </thead>
                <tbody id="costsByModelTable">
                    <tr><td colspan="7" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- COSTS BY STAGE -->
    <div class="section">
        <h2>๐ ุงูุชูุงููู ุญุณุจ ุงููุฑุญูุฉ</h2>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>ุงุณู ุงููุฑุญูุฉ</th>
                        <th>ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช</th>
                        <th>ุฑููุฒ ุงููุฏุฎูุงุช</th>
                        <th>ุฑููุฒ ุงููุฎุฑุฌุงุช</th>
                        <th>ุชูุงููู ุงููุฏุฎูุงุช</th>
                        <th>ุชูุงููู ุงููุฎุฑุฌุงุช</th>
                        <th>ุงูุฅุฌูุงูู</th>
                    </tr>
                </thead>
                <tbody id="costsByStageTable">
                    <tr><td colspan="7" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- COSTS PER USER -->
    <div class="section">
        <h2>๐ฅ ุงูุชูุงููู ุญุณุจ ุงููุณุชุฎุฏู</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <div class="stat-card">
                <h3>ูุชูุณุท ุงูุชูุงููู ูููุณุชุฎุฏู</h3>
                <div class="stat-number" id="avgCostPerUser">$0.00</div>
            </div>
            <div class="stat-card">
                <h3>ุฅุฌูุงูู ุชูุงููู ุงููุคุณุณุฉ</h3>
                <div class="stat-number" id="totalOrgCost">$0.00</div>
            </div>
        </div>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>ูุนุฑู ุงููุณุชุฎุฏู</th>
                        <th>ุงุณู ุงููุณุชุฎุฏู</th>
                        <th>ุนุฏุฏ ุงููุญุงุฏุซุงุช</th>
                        <th>ุฑููุฒ ุงููุฏุฎูุงุช</th>
                        <th>ุฑููุฒ ุงููุฎุฑุฌุงุช</th>
                        <th>ุชูุงููู ุงููุฏุฎูุงุช</th>
                        <th>ุชูุงููู ุงููุฎุฑุฌุงุช</th>
                        <th>ุงูุฅุฌูุงูู</th>
                    </tr>
                </thead>
                <tbody id="costsPerUserTable">
                    <tr><td colspan="8" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

</div>

<!-- CHART.JS LIBRARY -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="/static/js/dashboard.js"></script>
</body>
</html>