graph TD
    A["๐ค Telegram User"] --> B{ููุน ุงูุฑุณุงูุฉ}
    
    %% ===== ุฃูุงูุฑ ุนุงูุฉ =====
    B -->|/start| C["โ ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ"]
    C --> C1["ุฅูุดุงุก UserInfo"]
    C1 --> C2["ุนุฑุถ ุฑุณุงูุฉ ุชุฑุญูุจ"]
    
    B -->|/help| D["๐ ุนุฑุถ ุงูุฃูุงูุฑ ุงููุชุงุญุฉ"]
    D --> D1{ุงูุฏูุฑ}
    D1 -->|ุนุถู ุนุงุฏู| D2["ุฃูุงูุฑ ูุญุฏูุฏุฉ"]
    D1 -->|ูุงูู ูุคุณุณุฉ| D3["ุฌููุน ุงูุฃูุงูุฑ"]
    
    B -->|/myinfo| E["๐ค ูุนูููุงุช ุงููุณุชุฎุฏู"]
    E --> E1["ุนุฑุถ: ุงูุฏูุฑุ ุงููุคุณุณุฉุ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุดุทุฉ"]
    
    B -->|/clear| F["๐๏ธ ุญุฐู ุงูุณุฌู"]
    F --> F1["ุชุฃููุฏ ูู ุงููุณุชุฎุฏู"]
    F1 --> F2["ุญุฐู ูู ุงูุฐุงูุฑุฉ ูุงููููุงุช"]
    
    B -->|/history| G["๐ ุขุฎุฑ 10 ูุญุงุฏุซุงุช"]
    G --> G1["ุนุฑุถ ุงูุฃุณุฆูุฉ ุงูุณุงุจูุฉ"]
    
    B -->|/stats| H["๐ ุฅุญุตุงุฆูุงุช ุงููุญุงุฏุซุฉ"]
    H --> H1["ุนุฏุฏ ุงูุฃุณุฆูุฉุ SQL queriesุ ุงูุชูุงููู"]
    
    %% ===== ุฃูุงูุฑ ุงููุคุณุณุงุช =====
    B -->|/org| I["๐ข ูุงุฆูุฉ ุงููุคุณุณุฉ"]
    I --> I1{ุงูุฏูุฑ}
    I1 -->|ููุณ ุนุถูุงู| I2["ุงูุชุฑุงุญ: /createorg ุฃู /join"]
    I1 -->|ุนุถู| I3["ุนุฑุถ ูุนูููุงุช ุงููุคุณุณุฉ<br/>ุฎูุงุฑุงุช ูุญุฏูุฏุฉ"]
    I1 -->|ูุงูู| I4["ุนุฑุถ ุฌููุน ุงูุฎูุงุฑุงุช:<br/>โ ุฅุถุงูุฉ ูุงุนุฏุฉ<br/>โ ุฅูุดุงุก ุฏุนูุฉ<br/>โ ุฅุฏุงุฑุฉ ุฃุนุถุงุก"]
    
    B -->|/createorg| J["โจ ุฅูุดุงุก ูุคุณุณุฉ ุฌุฏูุฏุฉ"]
    J --> J1{ุชุญูู: ููุณ ูู ูุคุณุณุฉ?}
    J1 -->|ูุนู| J2["ุชูููุฏ org_idุ ุจูุงูุงุช ุฏุฎูู ููุญุฉ ุงูุชุญูู"]
    J2 --> J3["ุชุฎุฒูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"]
    J3 --> J4["ุฅุฑุณุงู ุจูุงูุงุช ุงูุฏุฎูู ูููุณุชุฎุฏู"]
    J1 -->|ูุง| J5["โ ุฃูุช ุจุงููุนู ูู ูุคุณุณุฉ"]
    
    B -->|/orginfo| K["๐ ูุนูููุงุช ุงููุคุณุณุฉ"]
    K --> K1["ุนุฑุถ: ุงูุฃุนุถุงุกุ ููุงุนุฏ ุงูุจูุงูุงุชุ ุงูุชุงุฑูุฎ"]
    
    B -->|/adddb| L["โ ุฅุถุงูุฉ ูุงุนุฏุฉ ุจูุงูุงุช"]
    L --> L1{ุงูุฏูุฑ}
    L1 -->|ูุงูู ูุคุณุณุฉ| L2["ุฅุถุงูุฉ ูุฌููุน ุงูุฃุนุถุงุก"]
    L1 -->|ุนุถู ุนุงุฏู| L3["ุฅุถุงูุฉ ุดุฎุตูุฉ ููุท"]
    L1 -->|ุจุฏูู ูุคุณุณุฉ| L4["ุฅุถุงูุฉ ุดุฎุตูุฉ"]
    L2 --> L5["ุงูุชุญูู ูู ุงูุงุชุตุงู"]
    L3 --> L5
    L4 --> L5
    L5 --> L6["ุชุฎุฒูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"]
    
    B -->|/selectdb| M["๐๏ธ ุงุฎุชูุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช"]
    M --> M1["ุนุฑุถ ูุงุฆูุฉ ุงูููุงุนุณ ุงููุชุงุญุฉ"]
    M1 --> M2["ุชุนููู ููุงุนุฏุฉ ูุดุทุฉ"]
    
    B -->|/invite| N["๐ซ ุฅูุดุงุก ุฑุงุจุท ุฏุนูุฉ"]
    N --> N1{ุชุญูู: ูุงูู ูุคุณุณุฉ?}
    N1 -->|ูุนู| N2["ุชูููุฏ ุฑูุฒ + ููุช ุงูุชูุงุก"]
    N2 --> N3["ุชุญุฏูุฏ ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช"]
    N3 --> N4["ุฅุฑุณุงู ุงูุฑุงุจุท"]
    N1 -->|ูุง| N5["โ ุตูุงุญูุฉ ูุญุตูุฑุฉ ุนูู ุงููุงูู"]
    
    B -->|/join| O["๐ฅ ุงูุงูุถูุงู ููุคุณุณุฉ"]
    O --> O1{ุชุญูู: ุงูุฑุงุจุท ุตุญูุญ?}
    O1 -->|ูุนู| O2["ุชูููุฏ ุจูุงูุงุช ุฏุฎูู ููุญุฉ ุงูุชุญูู"]
    O2 --> O3["ุฅุถุงูุฉ ูุนุถู ูู ุงููุคุณุณุฉ"]
    O3 --> O4["ุฅุดุนุงุฑ ุงููุงูู"]
    O1 -->|ูุง| O5["โ ุฑุงุจุท ุบูุฑ ุตุญูุญ ุฃู ููุชูู ุงูุตูุงุญูุฉ"]
    
    %% ===== ุงูุฃุณุฆูุฉ ูุงููุนุงูุฌุฉ =====
    B -->|ุฑุณุงูุฉ ูุตูุฉ| P{"ุชุญูู ูู ุงููููุฏ"}
    P -->|ูุง ูุงุนุฏุฉ| P1["โ๏ธ ุงุฎุชุฑ ูุงุนุฏุฉ ุจูุงูุงุช ุฃููุงู"]
    P -->|Rate limit| P2["โณ ุงูุชุธุฑ ูุจู ุงูุณุคุงู ุงูุชุงูู"]
    P -->|ูุดุท ุฌุฏุงู| P3["๐ข ุทูุจุงุช ูุซูุฑุฉ ูุนููุฉ"]
    
    P -->|ููุฑ| Q["๐ค ูุนุงูุฌุฉ ุงูุณุคุงู"]
    Q --> Q1["ุงููุฑุญูุฉ 1: ุชุญููู ุงูุณุคุงู<br/>Gemini 2.5-Flash"]
    Q1 --> Q2{ุงูููุน}
    
    Q2 -->|ุงุณุชุนูุงู SQL| R["ุงููุฑุญูุฉ 2: ุชูููุฐ SQL<br/>Gemini 2.0-Flash"]
    Q2 -->|ุฅุฌุงุจุฉ ูุจุงุดุฑุฉ| S["ุฅุฑุณุงู ุงูุฅุฌุงุจุฉ"]
    Q2 -->|ุฅูููู| T["ุงููุฑุญูุฉ 3: ุชูููุฏ ุฅูููู<br/>Gemini 2.5-Flash"]
    
    R --> R1["ุญุณุงุจ ุงูุชูููุงุช"]
    R1 --> R2["ุญุณุงุจ ุงูุชูุงููู"]
    R2 --> S
    
    T --> T1["ุญุณุงุจ ุงูุชูููุงุช"]
    T1 --> T2["ุญุณุงุจ ุงูุชูุงููู"]
    T2 --> U["ุนุฑุถ ุฒุฑ ูุนุงููุฉ ุงูุฅูููู"]
    U --> U1{ุงุฎุชูุงุฑ ุงููุณุชุฎุฏู}
    U1 -->|ูุนุงููุฉ| U2["ุนุฑุถ ุงูุฅูููู"]
    U1 -->|ุฅุฑุณุงู| U3["ุฅุฑุณุงู ุนุจุฑ SMTP"]
    U1 -->|ุฅูุบุงุก| U4["ุฅูุบุงุก ุงูุนูููุฉ"]
    
    S --> V["๐พ ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"]
    V --> V1["ุฌุฏูู Conversations"]
    V2["ุฌุฏูู ConversationStages"]
    V3["ุชุญุฏูุซ ModelUsage"]
    V1 --> V2 --> V3
    V3 --> W["๐ฑ ุฅุฑุณุงู ุงูุฑุฏ ูููุณุชุฎุฏู"]
    
    style C fill:#0088cc,stroke:#005fa3,color:#fff
    style J fill:#27ae60,stroke:#1e8449,color:#fff
    style N fill:#f39c12,stroke:#d68910,color:#fff
    style O fill:#9b59b6,stroke:#7d3c98,color:#fff
    style Q fill:#e74c3c,stroke:#c0392b,color:#fff